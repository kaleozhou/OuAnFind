package ouanfind.com.service.impl;import java.util.Date;import java.text.SimpleDateFormat; import java.io.File;import java.io.FileInputStream;import java.io.FileNotFoundException;import java.io.FileOutputStream;import java.io.InputStream;import java.io.OutputStream;import java.util.List;import org.apache.poi.hssf.usermodel.HSSFCell;import org.apache.poi.hssf.usermodel.HSSFRow;import org.apache.poi.hssf.usermodel.HSSFSheet;import org.apache.poi.hssf.usermodel.HSSFWorkbook;import ouanfind.com.bean.*;import ouanfind.com.dao.FindusersDAO;import ouanfind.com.service.FindusersService;public class FindusersServiceImpl implements FindusersService {    private FindusersDAO findusersDao;    public FindusersDAO getFindusersDao() {        return findusersDao;    }    public void setFindusersDao(FindusersDAO findusersDao) {        this.findusersDao = findusersDao;    }    public void delete(Findusers findusers) {        this.findusersDao.removeFindusers(findusers);    }    public List<Findusers> findAll() {        return this.findusersDao.findAllFindusers();    }    public Findusers findByFindusers_id(Integer findusers_id) {        return this.findusersDao.findFindusersByFindusers_id(findusers_id);    }    public void save(Findusers findusers) {        this.findusersDao.saveFindusers(findusers);    }    public void update(Findusers findusers) {        this.findusersDao.updateFindusers(findusers);    }    public int findFindusersByFindusers_name_count( String findusers_name_c ){        return this.findusersDao.findFindusersByFindusers_name_count( findusers_name_c );    }    public List<Findusers> findFindusersByFindusers_name( String findusers_name_c , int currentPage,int lineSize) {        return this.findusersDao.findFindusersByFindusers_name( findusers_name_c ,currentPage,lineSize);    }    public List<Findusers> findFindusersByFindusers_name_excel( String findusers_name_c ) {        return this.findusersDao.findFindusersByFindusers_name_excel( findusers_name_c );    }    public InputStream getInputStream( String findusers_name_c ) {        SimpleDateFormat sd = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");        HSSFWorkbook wb = new HSSFWorkbook();        HSSFSheet sheet = wb.createSheet("RecordsSheet");        HSSFRow row = sheet.createRow(0);        HSSFCell cell = row.createCell((short) 0);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_id");        cell = row.createCell((short) 1);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_name");        cell = row.createCell((short) 2);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_realname");        cell = row.createCell((short) 3);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_nickname");        cell = row.createCell((short) 4);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_sex");        cell = row.createCell((short) 5);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_password");        cell = row.createCell((short) 6);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_age");        cell = row.createCell((short) 7);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_address");        cell = row.createCell((short) 8);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_provience");        cell = row.createCell((short) 9);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_city");        cell = row.createCell((short) 10);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_county");        cell = row.createCell((short) 11);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_email");        cell = row.createCell((short) 12);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_teleph");        cell = row.createCell((short) 13);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_nationality");        cell = row.createCell((short) 14);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_nation");        cell = row.createCell((short) 15);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_constellation");        cell = row.createCell((short) 16);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_bloodtype");        cell = row.createCell((short) 17);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_stature");        cell = row.createCell((short) 18);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_weight");        cell = row.createCell((short) 19);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_homepace");        cell = row.createCell((short) 20);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_datebirth");        cell = row.createCell((short) 21);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_vocation");        cell = row.createCell((short) 22);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_qq");        cell = row.createCell((short) 23);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_graduateschool");        cell = row.createCell((short) 24);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_currentcompany");        cell = row.createCell((short) 25);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_specialskill");        cell = row.createCell((short) 26);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_accomplish");        cell = row.createCell((short) 27);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_empiricvalue");        cell = row.createCell((short) 28);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_viplevel");        cell = row.createCell((short) 29);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_headsculpture1");        cell = row.createCell((short) 30);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_headsculpture2");        cell = row.createCell((short) 31);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_registerdate");        cell = row.createCell((short) 32);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_operater");        cell = row.createCell((short) 33);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_operatedate");        cell = row.createCell((short) 34);        cell.setEncoding(HSSFCell.ENCODING_UTF_16);        cell.setCellValue("findusers_status");        List<Findusers> list;        if ( findusers_name_c==null )            {             findusers_name_c="";            }        list = this.findFindusersByFindusers_name_excel( findusers_name_c );        for (int i = 0; i < list.size(); ++i) {            Findusers findusers = list.get(i);            row = sheet.createRow(i + 1);            cell = row.createCell((short) 0);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_id() != null) {                cell.setCellValue(findusers.getFindusers_id());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 1);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_name() != null) {                cell.setCellValue(findusers.getFindusers_name());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 2);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_realname() != null) {                cell.setCellValue(findusers.getFindusers_realname());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 3);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_nickname() != null) {                cell.setCellValue(findusers.getFindusers_nickname());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 4);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_sex() != null) {                cell.setCellValue(findusers.getFindusers_sex());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 5);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_password() != null) {                cell.setCellValue(findusers.getFindusers_password());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 6);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_age() != null) {                cell.setCellValue(findusers.getFindusers_age());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 7);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_address() != null) {                cell.setCellValue(findusers.getFindusers_address());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 8);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_provience() != null) {                cell.setCellValue(findusers.getFindusers_provience());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 9);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_city() != null) {                cell.setCellValue(findusers.getFindusers_city());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 10);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_county() != null) {                cell.setCellValue(findusers.getFindusers_county());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 11);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_email() != null) {                cell.setCellValue(findusers.getFindusers_email());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 12);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_teleph() != null) {                cell.setCellValue(findusers.getFindusers_teleph());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 13);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_nationality() != null) {                cell.setCellValue(findusers.getFindusers_nationality());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 14);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_nation() != null) {                cell.setCellValue(findusers.getFindusers_nation());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 15);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_constellation() != null) {                cell.setCellValue(findusers.getFindusers_constellation());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 16);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_bloodtype() != null) {                cell.setCellValue(findusers.getFindusers_bloodtype());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 17);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_stature() != null) {                cell.setCellValue(findusers.getFindusers_stature());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 18);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_weight() != null) {                cell.setCellValue(findusers.getFindusers_weight());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 19);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_homepace() != null) {                cell.setCellValue(findusers.getFindusers_homepace());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 20);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_datebirth() != null) {                cell.setCellValue(sd.format(findusers.getFindusers_datebirth()));            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 21);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_vocation() != null) {                cell.setCellValue(findusers.getFindusers_vocation());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 22);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_qq() != null) {                cell.setCellValue(findusers.getFindusers_qq());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 23);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_graduateschool() != null) {                cell.setCellValue(findusers.getFindusers_graduateschool());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 24);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_currentcompany() != null) {                cell.setCellValue(findusers.getFindusers_currentcompany());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 25);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_specialskill() != null) {                cell.setCellValue(findusers.getFindusers_specialskill());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 26);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_accomplish() != null) {                cell.setCellValue(findusers.getFindusers_accomplish());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 27);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_empiricvalue() != null) {                cell.setCellValue(findusers.getFindusers_empiricvalue());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 28);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_viplevel() != null) {                cell.setCellValue(findusers.getFindusers_viplevel());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 29);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_headsculpture1() != null) {                cell.setCellValue(findusers.getFindusers_headsculpture1());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 30);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_headsculpture2() != null) {                cell.setCellValue(findusers.getFindusers_headsculpture2());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 31);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_registerdate() != null) {                cell.setCellValue(sd.format(findusers.getFindusers_registerdate()));            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 32);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_operater() != null) {                cell.setCellValue(findusers.getFindusers_operater());            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 33);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_operatedate() != null) {                cell.setCellValue(sd.format(findusers.getFindusers_operatedate()));            } else {                cell.setCellValue("");            }            cell = row.createCell((short) 34);            cell.setEncoding(HSSFCell.ENCODING_UTF_16);            if (findusers.getFindusers_status() != null) {                cell.setCellValue(findusers.getFindusers_status());            } else {                cell.setCellValue("");            }        }        File file = new File("test.xls");        try {            OutputStream os = new FileOutputStream(file);            wb.write(os);            os.close();        } catch (Exception e) {            e.printStackTrace();        }        InputStream is = null;        try {            is = new FileInputStream(file);        } catch (FileNotFoundException e) {            e.printStackTrace();        }        return is;    }    public List<Findusers_findusers_sex_dict_finddictionary_finddictionary_value>getFindusers_findusers_sex_dict_finddictionary_finddictionary_value()    {     return this.findusersDao.getFindusers_findusers_sex_dict_finddictionary_finddictionary_value();    }}
